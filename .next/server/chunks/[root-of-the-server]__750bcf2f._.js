module.exports=[70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},47044,(e,t,r)=>{t.exports=e.x("jsonwebtoken-cc89c121a8bdfb14",()=>require("jsonwebtoken-cc89c121a8bdfb14"))},21503,e=>e.a(async(t,r)=>{try{let t=await e.y("pg-519b72043f8edc04");e.n(t),r()}catch(e){r(e)}},!0),64104,e=>e.a(async(t,r)=>{try{var n=e.i(21503),o=t([n]);if([n]=o.then?(await o)():o,!process.env.DATABASE_URL)throw console.error("❌ DATABASE_URL não está configurada!"),console.error("❌ Configure DATABASE_URL no arquivo .env.local ou nas variáveis de ambiente"),Error("DATABASE_URL não configurada. Configure no .env.local ou variáveis de ambiente.");let s=new n.Pool({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1},max:20,idleTimeoutMillis:3e4,connectionTimeoutMillis:2e3});s.on("connect",()=>{console.log("✅ Conectado ao banco de dados Neon")}),s.on("error",e=>{console.error("❌ Erro no pool de conexões:",e)}),e.s(["default",0,s]),r()}catch(e){r(e)}},!1),63963,e=>{"use strict";var t=e.i(47044);let r=process.env.JWT_SECRET||"your-secret-key-change-in-production";function n(e,n,o){let s=e.headers.authorization,a=s&&s.split(" ")[1];if(!a)return n.status(401).json({error:"Token não fornecido"});try{e.user=t.default.verify(a,r),o()}catch(e){return n.status(403).json({error:"Token inválido ou expirado"})}}function o(e,t,r){if(e.user?.role!=="admin")return t.status(403).json({error:"Acesso negado. Admin necessário."});r()}process.env.JWT_SECRET||console.warn("⚠️  JWT_SECRET não configurado! Usando valor padrão inseguro."),e.s(["authenticateToken",()=>n,"requireAdmin",()=>o])},14123,e=>e.a(async(t,r)=>{try{var n=e.i(63963),o=e.i(64104),s=t([o]);async function a(e,t){return(t.setHeader("Access-Control-Allow-Credentials","true"),t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Access-Control-Allow-Methods","GET,OPTIONS"),t.setHeader("Access-Control-Allow-Headers","X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version, Authorization"),"OPTIONS"===e.method)?void t.status(200).end():(0,n.authenticateToken)(e,t,async()=>{try{let r=e.user,{dossierId:n,sectionCode:s}=e.query;if(!n)return t.status(400).json({error:"dossierId é obrigatório"});let a=await o.default.query("SELECT clinic_id, title FROM dossiers WHERE id = $1",[n]);if(0===a.rows.length)return t.status(404).json({error:"Dossiê não encontrado"});let i=a.rows[0].clinic_id;if("admin"!==r.role&&r.clinicId!==i)return t.status(403).json({error:"Acesso negado a este dossiê"});let d=`
        SELECT
          a.id,
          a.dossier_id,
          a.question_id,
          a.value_text,
          a.value_number,
          a.value_json,
          a.source,
          a.updated_at,
          q.code as question_code,
          q.text as question_text,
          q.type as question_type,
          s.code as section_code,
          s.name as section_name
        FROM answers a
        JOIN questions q ON q.id = a.question_id
        JOIN question_sets qs ON qs.id = q.question_set_id
        JOIN sections s ON s.id = qs.section_id
        WHERE a.dossier_id = $1
      `,u=[n];s&&(d+=" AND s.code = $2",u.push(s)),d+=" ORDER BY a.updated_at DESC";let l=await o.default.query(d,u);return t.status(200).json({dossier:a.rows[0],answersCount:l.rows.length,answers:l.rows})}catch(e){return console.error("Erro na API de debug de respostas:",e),t.status(500).json({error:e.message})}})}[o]=s.then?(await s)():s,e.s(["default",()=>a]),r()}catch(e){r(e)}},!1),96817,e=>e.a(async(t,r)=>{try{var n=e.i(93957),o=e.i(72664),s=e.i(61471),a=e.i(65751),i=e.i(14123),d=e.i(90078),u=e.i(57218),l=e.i(2576),c=t([i]);[i]=c.then?(await c)():c;let h=(0,a.hoist)(i,"default"),v=(0,a.hoist)(i,"config"),w=new s.PagesAPIRouteModule({definition:{kind:o.RouteKind.PAGES_API,page:"/api/debug/answers",pathname:"/api/debug/answers",bundlePath:"",filename:""},userland:i,distDir:".next",relativeProjectDir:""});async function p(e,t,r){w.isDev&&(0,l.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let o="/api/debug/answers";o=o.replace(/\/index$/,"")||"/";let s=await w.prepare(e,t,{srcPage:o});if(!s){t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve());return}let{query:a,params:i,prerenderManifest:c,routerServerContext:p}=s;try{let r=e.method||"GET",n=(0,d.getTracer)(),s=n.getActiveScopeSpan(),l=w.instrumentationOnRequestError.bind(w),h=async s=>w.render(e,t,{query:{...a,...i},params:i,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:c.preview,propagateError:!1,dev:w.isDev,page:"/api/debug/answers",internalRevalidate:null==p?void 0:p.revalidate,onError:(...t)=>l(e,...t)}).finally(()=>{if(!s)return;s.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let e=n.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=e.get("next.route");if(a){let e=`${r} ${a}`;s.setAttributes({"next.route":a,"http.route":a,"next.span_name":e}),s.updateName(e)}else s.updateName(`${r} ${o}`)});s?await h(s):await n.withPropagatedContext(e.headers,()=>n.trace(u.BaseServerSpan.handleRequest,{spanName:`${r} ${o}`,kind:d.SpanKind.SERVER,attributes:{"http.method":r,"http.target":e.url}},h))}catch(e){if(w.isDev)throw e;(0,n.sendError)(t,500,"Internal Server Error")}finally{null==r.waitUntil||r.waitUntil.call(r,Promise.resolve())}}e.s(["config",0,v,"default",0,h,"handler",()=>p]),r()}catch(e){r(e)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__750bcf2f._.js.map