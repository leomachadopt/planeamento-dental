(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18931,e=>{"use strict";let t=(0,e.i(40895).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],18931)},4258,e=>{"use strict";let t=(0,e.i(40895).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],4258)},43656,e=>{"use strict";let t=(0,e.i(40895).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>t],43656)},84630,e=>{"use strict";let t=(0,e.i(40895).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],84630)},85105,e=>{"use strict";let t=(0,e.i(40895).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>t],85105)},163,e=>{"use strict";let t=(0,e.i(40895).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>t],163)},41655,e=>{"use strict";var t=e.i(43935),a=e.i(68196),s=e.i(80087),o=e.i(7980),i=e.i(88091),r=e.i(98189),n=e.i(39229),l=e.i(67921),c=e.i(82147),d=e.i(63624),x="Checkbox",[u,h]=(0,o.createContextScope)(x),[m,p]=u(x);function g(e){let{__scopeCheckbox:s,checked:o,children:i,defaultChecked:n,disabled:l,form:c,name:d,onCheckedChange:u,required:h,value:p="on",internal_do_not_use_render:g}=e,[v,j]=(0,r.useControllableState)({prop:o,defaultProp:n??!1,onChange:u,caller:x}),[_,f]=a.useState(null),[w,N]=a.useState(null),b=a.useRef(!1),C=!_||!!c||!!_.closest("form"),k={checked:v,disabled:l,setChecked:j,control:_,setControl:f,name:d,form:c,value:p,hasConsumerStoppedPropagationRef:b,required:h,defaultChecked:!y(n)&&n,isFormControl:C,bubbleInput:w,setBubbleInput:N};return(0,t.jsx)(m,{scope:s,...k,children:"function"==typeof g?g(k):i})}var v="CheckboxTrigger",j=a.forwardRef(({__scopeCheckbox:e,onKeyDown:o,onClick:r,...n},l)=>{let{control:c,value:x,disabled:u,checked:h,required:m,setControl:g,setChecked:j,hasConsumerStoppedPropagationRef:_,isFormControl:f,bubbleInput:w}=p(v,e),N=(0,s.useComposedRefs)(l,g),b=a.useRef(h);return a.useEffect(()=>{let e=c?.form;if(e){let t=()=>j(b.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[c,j]),(0,t.jsx)(d.Primitive.button,{type:"button",role:"checkbox","aria-checked":y(h)?"mixed":h,"aria-required":m,"data-state":C(h),"data-disabled":u?"":void 0,disabled:u,value:x,...n,ref:N,onKeyDown:(0,i.composeEventHandlers)(o,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,i.composeEventHandlers)(r,e=>{j(e=>!!y(e)||!e),w&&f&&(_.current=e.isPropagationStopped(),_.current||e.stopPropagation())})})});j.displayName=v;var _=a.forwardRef((e,a)=>{let{__scopeCheckbox:s,name:o,checked:i,defaultChecked:r,required:n,disabled:l,value:c,onCheckedChange:d,form:x,...u}=e;return(0,t.jsx)(g,{__scopeCheckbox:s,checked:i,defaultChecked:r,disabled:l,required:n,onCheckedChange:d,name:o,form:x,value:c,internal_do_not_use_render:({isFormControl:e})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j,{...u,ref:a,__scopeCheckbox:s}),e&&(0,t.jsx)(b,{__scopeCheckbox:s})]})})});_.displayName=x;var f="CheckboxIndicator",w=a.forwardRef((e,a)=>{let{__scopeCheckbox:s,forceMount:o,...i}=e,r=p(f,s);return(0,t.jsx)(c.Presence,{present:o||y(r.checked)||!0===r.checked,children:(0,t.jsx)(d.Primitive.span,{"data-state":C(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:a,style:{pointerEvents:"none",...e.style}})})});w.displayName=f;var N="CheckboxBubbleInput",b=a.forwardRef(({__scopeCheckbox:e,...o},i)=>{let{control:r,hasConsumerStoppedPropagationRef:c,checked:x,defaultChecked:u,required:h,disabled:m,name:g,value:v,form:j,bubbleInput:_,setBubbleInput:f}=p(N,e),w=(0,s.useComposedRefs)(i,f),b=(0,n.usePrevious)(x),C=(0,l.useSize)(r);a.useEffect(()=>{if(!_)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,t=!c.current;if(b!==x&&e){let a=new Event("click",{bubbles:t});_.indeterminate=y(x),e.call(_,!y(x)&&x),_.dispatchEvent(a)}},[_,b,x,c]);let k=a.useRef(!y(x)&&x);return(0,t.jsx)(d.Primitive.input,{type:"checkbox","aria-hidden":!0,defaultChecked:u??k.current,required:h,disabled:m,name:g,value:v,form:j,...o,tabIndex:-1,ref:w,style:{...o.style,...C,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function y(e){return"indeterminate"===e}function C(e){return y(e)?"indeterminate":e?"checked":"unchecked"}b.displayName=N;var k=e.i(84630),S=e.i(69751);let q=a.forwardRef(({className:e,...a},s)=>(0,t.jsx)(_,{ref:s,className:(0,S.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...a,children:(0,t.jsx)(w,{className:(0,S.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(k.Check,{className:"h-4 w-4"})})}));q.displayName=_.displayName,e.s(["Checkbox",()=>q],41655)},83740,e=>{"use strict";var t=e.i(43935),a=e.i(68196),s=e.i(93639),o=e.i(18931),i=e.i(43656),r=e.i(4258),n=e.i(85105),l=e.i(4198),c=e.i(60949),d=e.i(40895);let x=(0,d.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var u=e.i(163);let h=(0,d.default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),m=(0,d.default)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);var p=e.i(51814),g=e.i(38334),v=e.i(2602),j=e.i(65586),_=e.i(20826),f=e.i(41655),w=e.i(93485),N=e.i(97219),b=e.i(9169),y=e.i(18593);async function C(e,t={}){let a=JSON.parse(localStorage.getItem("auth-storage")||"{}")?.state?.token,s={"Content-Type":"application/json",...t.headers};a&&(s.Authorization=`Bearer ${a}`);let o=await fetch(`/api${e}`,{...t,headers:s});if(!o.ok){if(401===o.status||403===o.status)throw Error("NÃ£o autorizado");try{let e=await o.json();console.log("âŒ Erro da API:",e);let t=Error(e.error||e.message||`Erro: ${o.status}`);throw e.existingId&&(t.existingId=e.existingId),e.existingText&&(t.existingText=e.existingText),t}catch(e){if(e instanceof Error&&e.message!==`Erro: ${o.status}`)throw e;throw Error(`Erro: ${o.status}`)}}return o.json()}function k(){let{sectionCode:e}=(0,s.useRouter)().query,[i,r]=(0,a.useState)([]),[n,l]=(0,a.useState)(""),[c,d]=(0,a.useState)("all"),[x,h]=(0,a.useState)([]),[m,v]=(0,a.useState)(null),[f,y]=(0,a.useState)(!1),[k,E]=(0,a.useState)(!1),[O,T]=(0,a.useState)(""),[I,P]=(0,a.useState)(!1);(0,a.useEffect)(()=>{z()},[]),(0,a.useEffect)(()=>{e&&"string"==typeof e&&l(e)},[e]),(0,a.useEffect)(()=>{n&&(c&&"all"!==c?B(n,c):B(n))},[n,c]);let z=async()=>{try{let e=await C("/admin/sections");r(e),e.length>0&&!n&&l(e[0].code)}catch(e){b.toast.error(e.message||"Erro ao carregar seÃ§Ãµes")}},B=async(e,t)=>{y(!0);try{let a=`/admin/questions?sectionCode=${e}`;t&&(a+=`&questionSetId=${t}`);let s=await C(a);h(s)}catch(e){b.toast.error(e.message||"Erro ao carregar perguntas")}finally{y(!1)}},D=async e=>{console.log("ğŸ’¾ Salvando pergunta:",{id:e.id,code:e.code,question_set_id:e.question_set_id,isEdit:!!e.id});try{let t=e.validation_schema;if(t&&"object"==typeof t){let e=Object.fromEntries(Object.entries(t).filter(([e,t])=>null!=t&&""!==t));t=Object.keys(e).length>0?e:void 0}let a=e.order_index;e.id||(a=x.length);let s={...e,order_index:a,validation_schema:t};if(console.log("ğŸ“¤ Dados a enviar:",s),e.id)await C(`/admin/questions/${e.id}`,{method:"PUT",body:JSON.stringify(s)}),b.toast.success("Pergunta atualizada!");else try{await C("/admin/questions",{method:"POST",body:JSON.stringify(s)}),b.toast.success("Pergunta criada!")}catch(e){if(console.log("ğŸ” Erro ao criar:",e),console.log("ğŸ” existingId:",e.existingId),console.log("ğŸ” existingText:",e.existingText),e.message?.includes("JÃ¡ existe uma pergunta")||e.message?.includes("duplicate")){let t=e.existingId,a=e.existingText;t?b.toast.error(`J\xe1 existe uma pergunta com o c\xf3digo "${s.code}" neste question set.`+(a?`

Pergunta existente: "${a}"`:""),{duration:7e3,action:{label:"Editar existente",onClick:()=>{if(v(t),n){let e=c&&"all"!==c?c:void 0;B(n,e)}}}}):b.toast.error("JÃ¡ existe uma pergunta com este cÃ³digo neste question set. Edite a pergunta existente ou altere o cÃ³digo.");return}throw e}if(v(null),n){let e=c&&"all"!==c?c:void 0;B(n,e)}}catch(t){let e=t.message||"Erro ao salvar pergunta";e.includes("JÃ¡ existe uma pergunta"),b.toast.error(e)}},L=async e=>{if(confirm("Tem certeza que deseja excluir esta pergunta?"))try{if(await C(`/admin/questions/${e}`,{method:"DELETE"}),b.toast.success("Pergunta excluÃ­da!"),n){let e=c&&"all"!==c?c:void 0;B(n,e)}}catch(e){b.toast.error(e.message||"Erro ao excluir pergunta")}},R=async(e,t)=>{let a=x.findIndex(t=>t.id===e);if(-1===a)return;let s="up"===t?a-1:a+1;if(s<0||s>=x.length)return;let o=[...x],[i]=o.splice(a,1);o.splice(s,0,i),h(o);try{let e=o.map((e,t)=>({id:e.id,order_index:t}));await C("/admin/questions/reorder",{method:"POST",body:JSON.stringify({updates:e})}),b.toast.success("Ordem atualizada!")}catch(e){b.toast.error(e.message||"Erro ao reordenar perguntas"),n&&B(n,c&&"all"!==c?c:void 0)}},M=async()=>{if(!O.trim())return void b.toast.error("Por favor, cole o JSON do bloco");try{P(!0);let e=JSON.parse(O);if(!e.block)return void b.toast.error('JSON invÃ¡lido: esperado formato { "block": { ... } }');console.log("ğŸ“¦ Enviando importaÃ§Ã£o em lote:",e);let t=await C("/admin/questions/bulk-import",{method:"POST",body:JSON.stringify(e)});if(console.log("âœ… Resultado da importaÃ§Ã£o:",t),b.toast.success(`Importa\xe7\xe3o conclu\xedda! ${t.summary.imported} pergunta(s) importada(s), ${t.summary.skipped} ignorada(s), ${t.summary.errors} erro(s)`),E(!1),T(""),n){let e=c&&"all"!==c?c:void 0;B(n,e)}}catch(e){console.error("âŒ Erro na importaÃ§Ã£o:",e),b.toast.error("Erro ao importar: "+e.message)}finally{P(!1)}},J=i.find(e=>e.code===n),F=J?.questionSets||[];return(0,t.jsxs)("div",{className:"space-y-6 p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Gerenciar Perguntas"}),(0,t.jsx)("p",{className:"text-slate-500 mt-1",children:"Adicione, edite e personalize perguntas e seus contextos"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(p.Button,{variant:"outline",onClick:()=>E(!0),children:[(0,t.jsx)(u.Upload,{className:"mr-2 size-4"}),"Importar Bloco (JSON)"]}),(0,t.jsxs)(p.Button,{onClick:()=>v("new"),disabled:!c||"all"===c,children:[(0,t.jsx)(o.Plus,{className:"mr-2 size-4"}),"Nova Pergunta"]})]})]}),(0,t.jsxs)(g.Card,{children:[(0,t.jsx)(g.CardHeader,{children:(0,t.jsx)(g.CardTitle,{children:"Filtros"})}),(0,t.jsx)(g.CardContent,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Label,{children:"SeÃ§Ã£o"}),(0,t.jsxs)(w.Select,{value:n,onValueChange:l,children:[(0,t.jsx)(w.SelectTrigger,{children:(0,t.jsx)(w.SelectValue,{placeholder:"Selecione uma seÃ§Ã£o"})}),(0,t.jsx)(w.SelectContent,{children:i.map(e=>(0,t.jsxs)(w.SelectItem,{value:e.code,children:[e.name," (",e.code,")"]},e.id))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Label,{children:"Question Set (SubseÃ§Ã£o)"}),(0,t.jsxs)(w.Select,{value:c,onValueChange:d,children:[(0,t.jsx)(w.SelectTrigger,{children:(0,t.jsx)(w.SelectValue,{placeholder:"Todas as subseÃ§Ãµes"})}),(0,t.jsxs)(w.SelectContent,{children:[(0,t.jsx)(w.SelectItem,{value:"all",children:"Todas as subseÃ§Ãµes"}),F.map(e=>(0,t.jsxs)(w.SelectItem,{value:e.id,children:[e.name,e.subsection_name&&` - ${e.subsection_name}`]},e.id))]})]})]})]})})]}),f?(0,t.jsx)(g.Card,{children:(0,t.jsx)(g.CardContent,{className:"pt-6",children:(0,t.jsx)("div",{className:"text-center text-slate-500",children:"Carregando..."})})}):0===x.length?(0,t.jsx)(g.Card,{children:(0,t.jsx)(g.CardContent,{className:"pt-6",children:(0,t.jsx)("div",{className:"text-center text-slate-500",children:n?'Nenhuma pergunta encontrada. Clique em "Nova Pergunta" para criar.':"Selecione uma seÃ§Ã£o para ver as perguntas."})})}):(0,t.jsx)("div",{className:"space-y-4",children:x.map((e,a)=>(0,t.jsx)(S,{question:e,questionIndex:a,totalQuestions:x.length,isEditing:m===e.id,onEdit:()=>v(e.id||null),onSave:D,onDelete:L,onCancel:()=>v(null),onMoveUp:()=>e.id&&R(e.id,"up"),onMoveDown:()=>e.id&&R(e.id,"down")},e.id))}),"new"===m&&c&&"all"!==c&&(0,t.jsx)(q,{question:null,questionSetId:c,sectionCode:n,onSave:D,onCancel:()=>v(null)}),(0,t.jsx)(N.Dialog,{open:k,onOpenChange:E,children:(0,t.jsxs)(N.DialogContent,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,t.jsxs)(N.DialogHeader,{children:[(0,t.jsx)(N.DialogTitle,{children:"Importar Bloco de Perguntas via JSON"}),(0,t.jsx)(N.DialogDescription,{children:"Cole o JSON completo do bloco com todas as perguntas. O sistema criarÃ¡ automaticamente o question_set e todas as perguntas com seus contextos."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Label,{children:"JSON do Bloco"}),(0,t.jsx)(j.Textarea,{value:O,onChange:e=>T(e.target.value),placeholder:'{ "block": { "code": "OFFER_VALUE_PROPOSITION", "name": "Bloco 4 ...", "questions": [...] } }',className:"min-h-[400px] font-mono text-sm"})]}),(0,t.jsxs)("div",{className:"text-sm text-slate-500 space-y-2",children:[(0,t.jsx)("p",{className:"font-semibold",children:"Formato esperado:"}),(0,t.jsx)("pre",{className:"bg-slate-100 p-3 rounded text-xs overflow-x-auto",children:`{
  "block": {
    "code": "OFFER_VALUE_PROPOSITION",
    "name": "Bloco 4 â€” Oferta & Proposta de Valor",
    "description": "Define o que \xe9 vendido...",
    "questions": [
      {
        "code": "OFFER_CORE_PROBLEM",
        "text": "Qual \xe9 o principal problema...",
        "help_text": "Descreva o problema...",
        "type": "textarea",
        "required": true,
        "ai_importance_weight": 1.0,
        "validation_schema": {
          "min_length": 200,
          "max_length": 900
        },
        "options": [],
        "context": {
          "why": "Toda oferta forte...",
          "consequences": ["...", "..."],
          "how_to_answer": "Descreva...",
          "good_examples": ["..."],
          "bad_examples": ["..."],
          "show_why": true,
          "show_consequences": true,
          "show_how_to_answer": true,
          "show_good_examples": true,
          "show_bad_examples": true
        }
      },
      ...
    ]
  }
}`}),(0,t.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded p-3 mt-2",children:[(0,t.jsx)("p",{className:"font-semibold text-blue-900",children:"â„¹ï¸ Como funciona:"}),(0,t.jsxs)("ul",{className:"list-disc list-inside text-blue-800 space-y-1 mt-1",children:[(0,t.jsx)("li",{children:'O cÃ³digo da seÃ§Ã£o Ã© extraÃ­do automaticamente (ex: "OFFER" de "OFFER_VALUE_PROPOSITION")'}),(0,t.jsx)("li",{children:"Se o question_set jÃ¡ existir, as perguntas serÃ£o adicionadas a ele"}),(0,t.jsx)("li",{children:"Perguntas duplicadas (mesmo cÃ³digo) serÃ£o ignoradas"}),(0,t.jsx)("li",{children:"Os contextos sÃ£o criados automaticamente se a tabela existir"})]})]})]})]}),(0,t.jsxs)(N.DialogFooter,{children:[(0,t.jsx)(p.Button,{variant:"outline",onClick:()=>E(!1),disabled:I,children:"Cancelar"}),(0,t.jsx)(p.Button,{onClick:M,disabled:!O.trim()||I,children:I?"Importando...":"Importar"})]})]})})]})}function S({question:e,questionIndex:a,totalQuestions:s,isEditing:o,onEdit:n,onSave:l,onDelete:d,onCancel:x,onMoveUp:u,onMoveDown:v}){return o?(0,t.jsx)(q,{question:e,questionSetId:e.question_set_id,sectionCode:e.section_code,onSave:l,onCancel:x}):(0,t.jsxs)(g.Card,{children:[(0,t.jsx)(g.CardHeader,{children:(0,t.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1 pt-1",children:[(0,t.jsx)(p.Button,{variant:"ghost",size:"sm",onClick:u,disabled:0===a,className:"h-6 w-6 p-0",title:"Mover para cima",children:(0,t.jsx)(h,{className:"size-3"})}),(0,t.jsx)(p.Button,{variant:"ghost",size:"sm",onClick:v,disabled:a===s-1,className:"h-6 w-6 p-0",title:"Mover para baixo",children:(0,t.jsx)(m,{className:"size-3"})})]}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(g.CardTitle,{className:"text-lg",children:e.text}),(0,t.jsxs)(g.CardDescription,{children:["#",a+1," â€¢ ",e.code," â€¢ ",e.type,e.required&&" â€¢ ObrigatÃ³ria"]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(p.Button,{variant:"outline",size:"sm",onClick:n,children:(0,t.jsx)(i.Edit,{className:"size-4"})}),(0,t.jsx)(p.Button,{variant:"outline",size:"sm",onClick:()=>e.id&&d(e.id),children:(0,t.jsx)(r.Trash2,{className:"size-4"})})]})]})}),e.context&&(0,t.jsx)(g.CardContent,{children:(0,t.jsxs)("div",{className:"text-sm text-slate-600",children:[(0,t.jsx)(c.FileText,{className:"inline size-4 mr-1"}),"Contexto configurado"]})})]})}function q({question:e,questionSetId:s,sectionCode:i,onSave:r,onCancel:c}){let[d,h]=(0,a.useState)({id:e?.id,question_set_id:e?.question_set_id||s||"",code:e?.code||"",text:e?.text||"",help_text:e?.help_text||"",type:e?.type||"textarea",required:e?.required||!1,order_index:e?.order_index||0,ai_importance_weight:e?.ai_importance_weight||.5,validation_schema:e?.validation_schema||{},options:e?.options||[],context:e?.context||{show_why:!0,show_consequences:!0,show_how_to_answer:!0,show_good_examples:!0,show_bad_examples:!0}}),[m,k]=(0,a.useState)({label:"",value:""}),[S,q]=(0,a.useState)(!1),[E,O]=(0,a.useState)(""),T=(e,t)=>{if(!t.trim())return;let a=d.context||{},s=a[e]||[];h({...d,context:{...a,[e]:[...s,t.trim()]}})},I=(e,t)=>{let a=d.context||{},s=a[e]||[];h({...d,context:{...a,[e]:s.filter((e,a)=>a!==t)}})},P=async()=>{try{let e=JSON.parse(E);if(!e.code||!e.text||!e.type)return void b.toast.error("JSON invÃ¡lido: faltam campos obrigatÃ³rios (code, text, type)");let t=d.question_set_id;try{let a=(await C(`/admin/questions?sectionCode=${i}&questionSetId=${t}`)).find(a=>a.code===e.code&&a.question_set_id===t);if(a){h({id:a.id,question_set_id:t,code:e.code,text:e.text,help_text:e.help_text||"",type:e.type,required:e.required||!1,order_index:a.order_index,ai_importance_weight:e.ai_importance_weight||.5,validation_schema:e.validation_schema||{},options:e.options||[],context:e.context||{show_why:!0,show_consequences:!0,show_how_to_answer:!0,show_good_examples:!0,show_bad_examples:!0}}),q(!1),O(""),b.toast.success("Pergunta existente detectada. Os dados do JSON foram carregados. Ao salvar, a pergunta serÃ¡ atualizada.");return}}catch(e){console.warn("Erro ao verificar pergunta existente:",e)}h({question_set_id:t,code:e.code,text:e.text,help_text:e.help_text||"",type:e.type,required:e.required||!1,order_index:0,ai_importance_weight:e.ai_importance_weight||.5,validation_schema:e.validation_schema||{},options:e.options||[],context:e.context||{show_why:!0,show_consequences:!0,show_how_to_answer:!0,show_good_examples:!0,show_bad_examples:!0}}),q(!1),O(""),b.toast.success("JSON carregado com sucesso! Nova pergunta serÃ¡ criada.")}catch(e){b.toast.error("Erro ao parsear JSON: "+e.message)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(g.Card,{className:"border-2 border-teal-200",children:[(0,t.jsx)(g.CardHeader,{children:(0,t.jsx)(g.CardTitle,{children:e?"Editar Pergunta":"Nova Pergunta"})}),(0,t.jsxs)(g.CardContent,{className:"space-y-6",children:[(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Label,{children:"CÃ³digo da Pergunta *"}),(0,t.jsx)(v.Input,{value:d.code,onChange:e=>h({...d,code:e.target.value}),placeholder:"IDENTITY_REASON"}),(0,t.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Identificador Ãºnico da pergunta (ex: IDENTITY_REASON)"})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Label,{children:"Texto da Pergunta *"}),(0,t.jsx)(j.Textarea,{value:d.text,onChange:e=>h({...d,text:e.target.value}),placeholder:"Qual Ã© a razÃ£o de existir da sua clÃ­nica?",className:"min-h-[80px]"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Label,{children:"Texto de Ajuda"}),(0,t.jsx)(j.Textarea,{value:d.help_text||"",onChange:e=>h({...d,help_text:e.target.value}),placeholder:"Texto auxiliar que aparece abaixo da pergunta",className:"min-h-[60px]"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Label,{children:"Tipo de Resposta *"}),(0,t.jsxs)(w.Select,{value:d.type,onValueChange:e=>{h({...d,type:e,options:"single_select"===e||"multi_select"===e?d.options:[]})},children:[(0,t.jsx)(w.SelectTrigger,{children:(0,t.jsx)(w.SelectValue,{})}),(0,t.jsxs)(w.SelectContent,{children:[(0,t.jsx)(w.SelectItem,{value:"textarea",children:"Texto Longo"}),(0,t.jsx)(w.SelectItem,{value:"text",children:"Texto Curto"}),(0,t.jsx)(w.SelectItem,{value:"single_select",children:"SeleÃ§Ã£o Ãšnica"}),(0,t.jsx)(w.SelectItem,{value:"multi_select",children:"SeleÃ§Ã£o MÃºltipla"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Label,{children:"Peso para IA"}),(0,t.jsx)(v.Input,{type:"number",step:"0.1",min:"0",max:"1",value:d.ai_importance_weight||.5,onChange:e=>h({...d,ai_importance_weight:parseFloat(e.target.value)||.5})})]}),(0,t.jsx)("div",{className:"flex items-end",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(f.Checkbox,{id:"required",checked:d.required,onCheckedChange:e=>h({...d,required:!0===e})}),(0,t.jsx)(_.Label,{htmlFor:"required",className:"cursor-pointer",children:"ObrigatÃ³ria"})]})})]}),("text"===d.type||"textarea"===d.type)&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Label,{children:"MÃ­nimo de Caracteres"}),(0,t.jsx)(v.Input,{type:"number",min:"0",value:d.validation_schema?.min_length||"",onChange:e=>h({...d,validation_schema:{...d.validation_schema,min_length:e.target.value?parseInt(e.target.value):void 0}}),placeholder:"Ex: 10"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Label,{children:"MÃ¡ximo de Caracteres"}),(0,t.jsx)(v.Input,{type:"number",min:"0",value:d.validation_schema?.max_length||"",onChange:e=>h({...d,validation_schema:{...d.validation_schema,max_length:e.target.value?parseInt(e.target.value):void 0}}),placeholder:"Ex: 500"})]})]}),("single_select"===d.type||"multi_select"===d.type)&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(_.Label,{children:"OpÃ§Ãµes de Resposta"}),d.options?.map((e,a)=>(0,t.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,t.jsx)(v.Input,{value:e.label,onChange:e=>{let t=[...d.options||[]];t[a].label=e.target.value,h({...d,options:t})},placeholder:"Label da opÃ§Ã£o",className:"flex-1"}),(0,t.jsx)(v.Input,{value:e.value,onChange:e=>{let t=[...d.options||[]];t[a].value=e.target.value,h({...d,options:t})},placeholder:"Valor",className:"flex-1"}),(0,t.jsx)(p.Button,{variant:"outline",size:"sm",onClick:()=>{let e;return e=d.options||[],void h({...d,options:e.filter((e,t)=>t!==a)})},children:(0,t.jsx)(l.X,{className:"size-4"})})]},a)),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(v.Input,{value:m.label,onChange:e=>k({...m,label:e.target.value}),placeholder:"Nova opÃ§Ã£o - Label",className:"flex-1"}),(0,t.jsx)(v.Input,{value:m.value,onChange:e=>k({...m,value:e.target.value}),placeholder:"Valor",className:"flex-1"}),(0,t.jsx)(p.Button,{onClick:()=>{if(!m.label||!m.value)return;let e=d.options||[];h({...d,options:[...e,{label:m.label,value:m.value,order_index:e.length}]}),k({label:"",value:""})},variant:"outline",children:(0,t.jsx)(o.Plus,{className:"size-4"})})]})]}),(0,t.jsx)(y.Separator,{}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)(_.Label,{className:"text-lg font-semibold",children:"Contexto e OrientaÃ§Ãµes"})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(f.Checkbox,{id:"show_why",checked:d.context?.show_why!==!1,onCheckedChange:e=>h({...d,context:{...d.context,show_why:!0===e}})}),(0,t.jsx)(_.Label,{htmlFor:"show_why",className:"font-semibold cursor-pointer",children:"Por que estamos perguntando isso?"})]}),d.context?.show_why!==!1&&(0,t.jsx)(j.Textarea,{value:d.context?.why||"",onChange:e=>h({...d,context:{...d.context,why:e.target.value}}),placeholder:"ExplicaÃ§Ã£o do porquÃª a pergunta Ã© importante...",className:"min-h-[100px]"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(f.Checkbox,{id:"show_consequences",checked:d.context?.show_consequences!==!1,onCheckedChange:e=>h({...d,context:{...d.context,show_consequences:!0===e}})}),(0,t.jsx)(_.Label,{htmlFor:"show_consequences",className:"font-semibold cursor-pointer",children:"O que acontece sem isso?"})]}),d.context?.show_consequences!==!1&&(0,t.jsxs)("div",{className:"space-y-2",children:[(d.context?.consequences||[]).map((e,a)=>(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(v.Input,{value:e,onChange:e=>{let t=[...d.context?.consequences||[]];t[a]=e.target.value,h({...d,context:{...d.context,consequences:t}})},className:"flex-1"}),(0,t.jsx)(p.Button,{variant:"outline",size:"sm",onClick:()=>I("consequences",a),children:(0,t.jsx)(l.X,{className:"size-4"})})]},a)),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(v.Input,{placeholder:"Nova consequÃªncia",className:"flex-1",onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),T("consequences",e.currentTarget.value),e.currentTarget.value="")}}),(0,t.jsx)(p.Button,{variant:"outline",onClick:()=>{let e=document.querySelector('input[placeholder="Nova consequÃªncia"]');e&&(T("consequences",e.value),e.value="")},children:(0,t.jsx)(o.Plus,{className:"size-4"})})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(f.Checkbox,{id:"show_how_to_answer",checked:d.context?.show_how_to_answer!==!1,onCheckedChange:e=>h({...d,context:{...d.context,show_how_to_answer:!0===e}})}),(0,t.jsx)(_.Label,{htmlFor:"show_how_to_answer",className:"font-semibold cursor-pointer",children:"Como responder bem?"})]}),d.context?.show_how_to_answer!==!1&&(0,t.jsx)(j.Textarea,{value:d.context?.how_to_answer||"",onChange:e=>h({...d,context:{...d.context,how_to_answer:e.target.value}}),placeholder:"OrientaÃ§Ãµes de como responder bem...",className:"min-h-[100px]"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(f.Checkbox,{id:"show_good_examples",checked:d.context?.show_good_examples!==!1,onCheckedChange:e=>h({...d,context:{...d.context,show_good_examples:!0===e}})}),(0,t.jsx)(_.Label,{htmlFor:"show_good_examples",className:"font-semibold cursor-pointer",children:"Exemplos de boas respostas"})]}),d.context?.show_good_examples!==!1&&(0,t.jsxs)("div",{className:"space-y-2",children:[(d.context?.good_examples||[]).map((e,a)=>(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(j.Textarea,{value:e,onChange:e=>{let t=[...d.context?.good_examples||[]];t[a]=e.target.value,h({...d,context:{...d.context,good_examples:t}})},className:"flex-1 min-h-[60px]"}),(0,t.jsx)(p.Button,{variant:"outline",size:"sm",onClick:()=>I("good_examples",a),children:(0,t.jsx)(l.X,{className:"size-4"})})]},a)),(0,t.jsxs)(p.Button,{variant:"outline",onClick:()=>{let e=d.context?.good_examples||[];h({...d,context:{...d.context,good_examples:[...e,""]}})},children:[(0,t.jsx)(o.Plus,{className:"mr-2 size-4"}),"Adicionar Exemplo"]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(f.Checkbox,{id:"show_bad_examples",checked:d.context?.show_bad_examples!==!1,onCheckedChange:e=>h({...d,context:{...d.context,show_bad_examples:!0===e}})}),(0,t.jsx)(_.Label,{htmlFor:"show_bad_examples",className:"font-semibold cursor-pointer",children:"Exemplos de respostas ruins"})]}),d.context?.show_bad_examples!==!1&&(0,t.jsxs)("div",{className:"space-y-2",children:[(d.context?.bad_examples||[]).map((e,a)=>(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(j.Textarea,{value:e,onChange:e=>{let t=[...d.context?.bad_examples||[]];t[a]=e.target.value,h({...d,context:{...d.context,bad_examples:t}})},className:"flex-1 min-h-[60px]"}),(0,t.jsx)(p.Button,{variant:"outline",size:"sm",onClick:()=>I("bad_examples",a),children:(0,t.jsx)(l.X,{className:"size-4"})})]},a)),(0,t.jsxs)(p.Button,{variant:"outline",onClick:()=>{let e=d.context?.bad_examples||[];h({...d,context:{...d.context,bad_examples:[...e,""]}})},children:[(0,t.jsx)(o.Plus,{className:"mr-2 size-4"}),"Adicionar Exemplo"]})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between gap-2 pt-4",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(p.Button,{variant:"outline",onClick:()=>q(!0),children:[(0,t.jsx)(u.Upload,{className:"mr-2 size-4"}),"Carregar .json"]}),(0,t.jsxs)(p.Button,{variant:"outline",onClick:()=>{let e=JSON.stringify({code:d.code,text:d.text,help_text:d.help_text||"",type:d.type,required:d.required,ai_importance_weight:d.ai_importance_weight||.5,validation_schema:d.validation_schema||{},options:d.options||[],context:d.context||{}},null,2);navigator.clipboard.writeText(e),b.toast.success("JSON copiado para a Ã¡rea de transferÃªncia!")},children:[(0,t.jsx)(x,{className:"mr-2 size-4"}),"Copiar .json"]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(p.Button,{variant:"outline",onClick:c,children:"Cancelar"}),(0,t.jsxs)(p.Button,{onClick:()=>r(d),disabled:!d.code||!d.text||!d.question_set_id,children:[(0,t.jsx)(n.Save,{className:"mr-2 size-4"}),"Salvar"]})]})]})]})]}),(0,t.jsx)(N.Dialog,{open:S,onOpenChange:q,children:(0,t.jsxs)(N.DialogContent,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,t.jsxs)(N.DialogHeader,{children:[(0,t.jsx)(N.DialogTitle,{children:"Carregar Pergunta via JSON"}),(0,t.jsx)(N.DialogDescription,{children:"Cole o cÃ³digo JSON abaixo para preencher automaticamente todos os campos da pergunta."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Label,{children:"JSON da Pergunta"}),(0,t.jsx)(j.Textarea,{value:E,onChange:e=>O(e.target.value),placeholder:'{"code": "IDENTITY_REASON", "text": "Qual Ã© a razÃ£o de existir da sua clÃ­nica?", ...}',className:"min-h-[300px] font-mono text-sm"})]}),(0,t.jsxs)("div",{className:"text-sm text-slate-500 space-y-1",children:[(0,t.jsx)("p",{className:"font-semibold",children:"Formato esperado (ordem serÃ¡ definida automaticamente):"}),(0,t.jsx)("pre",{className:"bg-slate-100 p-2 rounded text-xs overflow-x-auto",children:`{
  "code": "IDENTITY_REASON",
  "text": "Qual \xe9 a raz\xe3o de existir da sua cl\xednica?",
  "help_text": "Texto auxiliar...",
  "type": "textarea",
  "required": true,
  "ai_importance_weight": 0.8,
  "validation_schema": {
    "min_length": 10,
    "max_length": 500
  },
  "options": [],
  "context": {
    "why": "...",
    "consequences": ["..."],
    "how_to_answer": "...",
    "good_examples": ["..."],
    "bad_examples": ["..."],
    "show_why": true,
    "show_consequences": true,
    "show_how_to_answer": true,
    "show_good_examples": true,
    "show_bad_examples": true
  }
}`})]})]}),(0,t.jsxs)(N.DialogFooter,{children:[(0,t.jsx)(p.Button,{variant:"outline",onClick:()=>q(!1),children:"Cancelar"}),(0,t.jsx)(p.Button,{onClick:P,disabled:!E.trim(),children:"Carregar"})]})]})})]})}e.s(["default",()=>k],83740)},42982,(e,t,a)=>{let s="/admin/perguntas";(window.__NEXT_P=window.__NEXT_P||[]).push([s,()=>e.r(83740)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([s])})},64270,e=>{e.v(t=>Promise.all(["static/chunks/4ddff7bfb1602969.js"].map(t=>e.l(t))).then(()=>t(71742)))},69238,e=>{e.v(t=>Promise.all(["static/chunks/fd5ef8daa941afe5.js"].map(t=>e.l(t))).then(()=>t(38426)))}]);